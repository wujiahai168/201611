{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\cases\\03_gameplay\\01_player_control\\DeviceMotion/assets\\cases\\03_gameplay\\01_player_control\\DeviceMotion\\DeviceMotionCtrl.js"],"names":["i18n","require","cc","Class","extends","Component","properties","speed","target","Node","btn_label","Label","_time","_range","v2","_acc","onLoad","_enabled","screenSize","view","getVisibleSize","x","width","y","height","systemEvent","on","SystemEvent","EventType","DEVICEMOTION","onDeviceMotionEvent","onOpenAccelerometer","textKey","t","setAccelerometerEnabled","onDestroy","off","event","acc","update","dt","range","misc","clampf"],"mappings":"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","file":"DeviceMotionCtrl.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\cases\\03_gameplay\\01_player_control\\DeviceMotion","sourcesContent":["const i18n = require('i18n');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        speed: 200,\n        target: cc.Node,\n        btn_label: cc.Label,\n        _time: 0,\n        _range: cc.v2(0, 0),\n        _acc: cc.v2(0, 0)\n    },\n\n    onLoad () {\n        this._enabled = false;\n        var screenSize = cc.view.getVisibleSize();\n        this._range.x = screenSize.width / 2 - this.target.width / 2;\n        this._range.y = screenSize.height / 2 - this.target.height / 2;\n        cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\n    },\n\n    onOpenAccelerometer () {\n        this._enabled = !this._enabled;\n        if (this._enabled) {\n            this.btn_label.textKey = i18n.t('cases/03_gameplay/01_player_control/On/DeviceMotion.fire.2');\n        }\n        else {\n            this.btn_label.textKey = i18n.t('cases/03_gameplay/01_player_control/On/DeviceMotion.fire.1');\n        }\n        if (!this._enabled) {\n            this._acc.x =  0;\n            this._acc.y =  0;\n            this._time = 0;\n        }\n        cc.systemEvent.setAccelerometerEnabled(this._enabled);\n    },\n\n    onDestroy () {\n        cc.systemEvent.setAccelerometerEnabled(false);\n        cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\n    },\n\n    onDeviceMotionEvent (event) {\n        this._acc.x =  event.acc.x;\n        this._acc.y =  event.acc.y;\n    },\n\n    update (dt) {\n        var target = this.target, range = this._range;\n        this._time += 5;\n        target.x += this._acc.x * dt * (this.speed + this._time);\n        target.x = cc.misc.clampf(target.x, -range.x, range.x);\n        target.y += this._acc.y * dt * (this.speed + this._time);\n        target.y = cc.misc.clampf(target.y, -range.y, range.y);\n\n        if (target.x <= -range.x || target.x >= range.x ||\n            target.y <= -range.y || target.y >= range.y) {\n            this._time = 0;\n        }\n    }\n\n});\n"]}