{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\cases\\05_scripting\\10_loadingBar/assets\\cases\\05_scripting\\10_loadingBar\\LoadingBarCtrl.js"],"names":["i18n","require","cc","Class","extends","Component","properties","progressBar","default","type","ProgressBar","progressTips","Label","laodBg","Node","onLoad","_urls","url","raw","resource","progress","_clearAll","textKey","t","node","on","EventType","TOUCH_START","loader","load","_progressCallback","bind","_completeCallback","i","length","release","completedCount","totalCount","res","error","update","dt","active","enabled","id"],"mappings":"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","file":"LoadingBarCtrl.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\cases\\05_scripting\\10_loadingBar","sourcesContent":["const i18n = require('i18n');\n\n//\n// 本教程主要还是体现如何使用Loader的进度条。\n//\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        progressBar: {\n            default: null,\n            type: cc.ProgressBar\n        },\n\n        progressTips: {\n            default: null,\n            type: cc.Label\n        },\n\n        laodBg: {\n            default: null,\n            type: cc.Node\n        }\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this._urls = [\n            cc.url.raw(\"resources/audio/ding.wav\"),\n            cc.url.raw(\"resources/audio/cheering.wav\"),\n            cc.url.raw(\"resources/audio/music_logo.mp3\"),\n            cc.url.raw(\"resources/test_assets/audio.mp3\"),\n            cc.url.raw(\"resources/loadingBar/font.png\"),\n            cc.url.raw(\"resources/loadingBar/mikado_outline_shadow.png\"),\n            cc.url.raw(\"resources/loadingBar/enligsh-chinese.png\")\n        ];\n        this.resource = null;\n        this.progressBar.progress = 0;\n        this._clearAll();\n        this.progressTips.textKey = i18n.t(\"cases/05_scripting/10_loadingBar/LoadingBarCtrl.js.3\");\n        this.node.on(cc.Node.EventType.TOUCH_START, function () {\n            if (this.resource) { return; }\n            cc.loader.load(this._urls, this._progressCallback.bind(this), this._completeCallback.bind(this));\n        }, this);\n    },\n\n    _clearAll: function () {\n        for (var i = 0; i < this._urls.length; ++i) {\n            var url = this._urls[i];\n            cc.loader.release(url);\n        }\n    },\n\n    _progressCallback: function (completedCount, totalCount, res) {\n        this.progress = completedCount / totalCount;\n        this.resource = res;\n        this.completedCount = completedCount;\n        this.totalCount = totalCount;\n    },\n\n    _completeCallback: function (error, res) {\n\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        if (!this.resource) {\n            return;\n        }\n        var progress = this.progressBar.progress;\n        if (progress >= 1) {\n            this.progressTips.textKey = i18n.t(\"cases/05_scripting/10_loadingBar/LoadingBarCtrl.js.1\");\n            this.laodBg.active = false;\n            this.progressBar.node.active = false;\n            this.enabled = false;\n            return;\n        }\n        if (progress < this.progress) {\n            progress += dt;\n        }\n        this.progressBar.progress = progress;\n        this.progressTips.textKey = i18n.t(\"cases/05_scripting/10_loadingBar/LoadingBarCtrl.js.2\")+ this.resource.id + \" (\" + this.completedCount + \"/\" + this.totalCount + \")\";\n    }\n});\n"]}