{"version":3,"sources":["OnMultiTouchCtrl.js"],"names":["cc","Class","extends","Component","properties","canvas","Node","target","onLoad","self","parent","node","on","EventType","TOUCH_MOVE","event","touches","getTouches","length","touch1","touch2","delta1","getDelta","delta2","touchPoint1","convertToNodeSpaceAR","getLocation","touchPoint2","distance","sub","delta","scale","Math","abs","x","y"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,gBAAQL,GAAGM,IADH;AAERC,gBAAQP,GAAGM;AAFH,KAHP;;AAQLE,YAAQ,kBAAY;AAChB,YAAIC,OAAO,IAAX;AAAA,YAAiBC,SAAS,KAAKC,IAAL,CAAUD,MAApC;AACAD,aAAKJ,MAAL,CAAYO,EAAZ,CAAeZ,GAAGM,IAAH,CAAQO,SAAR,CAAkBC,UAAjC,EAA6C,UAAUC,KAAV,EAAiB;AAC1D,gBAAIC,UAAUD,MAAME,UAAN,EAAd;AACA,gBAAID,QAAQE,MAAR,IAAkB,CAAtB,EAAyB;AACrB,oBAAIC,SAASH,QAAQ,CAAR,CAAb;AAAA,oBAAyBI,SAASJ,QAAQ,CAAR,CAAlC;AACA,oBAAIK,SAASF,OAAOG,QAAP,EAAb;AAAA,oBAAgCC,SAASH,OAAOE,QAAP,EAAzC;AACA,oBAAIE,cAAcd,OAAOe,oBAAP,CAA4BN,OAAOO,WAAP,EAA5B,CAAlB;AACA,oBAAIC,cAAcjB,OAAOe,oBAAP,CAA4BL,OAAOM,WAAP,EAA5B,CAAlB;AACA;AACA,oBAAIE,WAAWJ,YAAYK,GAAZ,CAAgBF,WAAhB,CAAf;AACA,oBAAIG,QAAQT,OAAOQ,GAAP,CAAWN,MAAX,CAAZ;AACA,oBAAIQ,QAAQ,CAAZ;AACA,oBAAIC,KAAKC,GAAL,CAASL,SAASM,CAAlB,IAAuBF,KAAKC,GAAL,CAASL,SAASO,CAAlB,CAA3B,EAAiD;AAC7CJ,4BAAQ,CAACH,SAASM,CAAT,GAAaJ,MAAMI,CAApB,IAAyBN,SAASM,CAAlC,GAAsCzB,KAAKF,MAAL,CAAYwB,KAA1D;AACH,iBAFD,MAGK;AACDA,4BAAQ,CAACH,SAASO,CAAT,GAAaL,MAAMK,CAApB,IAAyBP,SAASO,CAAlC,GAAsC1B,KAAKF,MAAL,CAAYwB,KAA1D;AACH;AACDtB,qBAAKF,MAAL,CAAYwB,KAAZ,GAAoBA,QAAQ,GAAR,GAAc,GAAd,GAAoBA,KAAxC;AACH;AACJ,SAnBD,EAmBGtB,KAAKE,IAnBR;AAoBH;AA9BI,CAAT","file":"OnMultiTouchCtrl.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\cases\\03_gameplay\\01_player_control\\OnMultiTouch","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        canvas: cc.Node,\n        target: cc.Node\n    },\n\n    onLoad: function () {\n        var self = this, parent = this.node.parent;\n        self.canvas.on(cc.Node.EventType.TOUCH_MOVE, function (event) {\n            var touches = event.getTouches();\n            if (touches.length >= 2) {\n                var touch1 = touches[0], touch2 = touches[1];\n                var delta1 = touch1.getDelta(), delta2 = touch2.getDelta();\n                var touchPoint1 = parent.convertToNodeSpaceAR(touch1.getLocation());\n                var touchPoint2 = parent.convertToNodeSpaceAR(touch2.getLocation());\n                //缩放\n                var distance = touchPoint1.sub(touchPoint2);\n                var delta = delta1.sub(delta2);\n                var scale = 1;\n                if (Math.abs(distance.x) > Math.abs(distance.y)) {\n                    scale = (distance.x + delta.x) / distance.x * self.target.scale;\n                }\n                else {\n                    scale = (distance.y + delta.y) / distance.y * self.target.scale;\n                }\n                self.target.scale = scale < 0.1 ? 0.1 : scale;\n            }\n        }, self.node);\n    }\n});\n"]}