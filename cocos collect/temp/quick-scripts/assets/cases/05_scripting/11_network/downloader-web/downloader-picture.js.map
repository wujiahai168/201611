{"version":3,"sources":["downloader-picture.js"],"names":["i18n","require","cc","Class","extends","Component","properties","remindLabel","default","type","Label","inputUrlBox","EditBox","picNode","Sprite","_picUrl","onLoad","textKey","startLoad","string","loader","load","url","onProgress","bind","picLoadComplete","t","err","res","console","log","spriteFrame","SpriteFrame","node","active","completedCount","totalCount"],"mappings":";;;;;;AAAA,IAAMA,OAAOC,QAAQ,MAAR,CAAb;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,qBAAa;AACTC,qBAAS,IADA;AAETC,kBAAMP,GAAGQ;AAFA,SADL;AAKRC,qBAAa;AACTH,qBAAS,IADA;AAETC,kBAAMP,GAAGU;AAFA,SALL;AASRC,iBAAS;AACLL,qBAAS,IADJ;AAELC,kBAAMP,GAAGY;AAFJ,SATD;AAaRC,iBAAS;AAbD,KAHP;;AAmBLC,UAnBK,oBAmBK;AACN,aAAKT,WAAL,CAAiBU,OAAjB,GAA2B,EAA3B;AACH,KArBI;AAuBLC,aAvBK,uBAuBQ;AACT;AACA,aAAKH,OAAL,GAAe,KAAKJ,WAAL,CAAiBQ,MAAhC;AACA;AACA,YAAI,KAAKJ,OAAT,EAAkB;AACdb,eAAGkB,MAAH,CAAUC,IAAV,CAAe,EAACC,KAAK,KAAKP,OAAX,EAAoBN,MAAM,KAA1B,EAAf,EAAiD,KAAKc,UAAL,CAAgBC,IAAhB,CAAqB,IAArB,CAAjD,EAA6E,KAAKC,eAAL,CAAqBD,IAArB,CAA0B,IAA1B,CAA7E;AACA,iBAAKjB,WAAL,CAAiBU,OAAjB,GAA2BjB,KAAK0B,CAAL,CAAO,mDAAP,CAA3B;AACH,SAHD,MAIK;AACD,iBAAKnB,WAAL,CAAiBU,OAAjB,GAA2BjB,KAAK0B,CAAL,CAAO,oDAAP,CAA3B;AACH;AACJ,KAlCI;AAoCLD,mBApCK,2BAoCYE,GApCZ,EAoCiBC,GApCjB,EAoCsB;AACvB,YAAID,OAAO,CAACC,GAAZ,EAAiB;AACbC,oBAAQC,GAAR,CAAYH,GAAZ;AACA,iBAAKpB,WAAL,CAAiBU,OAAjB,GAA4BjB,KAAK0B,CAAL,CAAO,qDAAP,CAA5B;AACA;AACH;;AAED,aAAKnB,WAAL,CAAiBU,OAAjB,GAA2BjB,KAAK0B,CAAL,CAAO,qDAAP,CAA3B;;AAEA,YAAIK,cAAc,IAAI7B,GAAG8B,WAAP,CAAmBJ,GAAnB,CAAlB;AACA,aAAKf,OAAL,CAAakB,WAAb,GAA2BA,WAA3B;AACA,aAAKlB,OAAL,CAAaoB,IAAb,CAAkBC,MAAlB,GAA2B,IAA3B;AACH,KAhDI;AAkDLX,cAlDK,sBAkDOY,cAlDP,EAkDuBC,UAlDvB,EAkDmC;AACpC,aAAK7B,WAAL,CAAiBU,OAAjB,GAA8BjB,KAAK0B,CAAL,CAAO,mDAAP,CAA9B,SAA8FS,iBAAeC,UAAhB,GAA8B,GAA3H;AACH;AApDI,CAAT","file":"downloader-picture.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\cases\\05_scripting\\11_network\\downloader-web","sourcesContent":["const i18n = require('i18n');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        remindLabel: {\n            default: null,\n            type: cc.Label\n        },\n        inputUrlBox: {\n            default: null,\n            type: cc.EditBox\n        },\n        picNode: {\n            default: null,\n            type: cc.Sprite\n        },\n        _picUrl: 'http://tools.itharbors.com/christmas/res/tree.png'\n    },\n\n    onLoad () {\n        this.remindLabel.textKey = '';\n    },\n\n    startLoad () {\n        // set url\n        this._picUrl = this.inputUrlBox.string;\n        // download pic\n        if (this._picUrl) {\n            cc.loader.load({url: this._picUrl, type: 'png'}, this.onProgress.bind(this), this.picLoadComplete.bind(this));\n            this.remindLabel.textKey = i18n.t('cases/05_scripting/11_network/download-web.fire.2');\n        }\n        else {\n            this.remindLabel.textKey = i18n.t('cases/05_scripting/11_network/download-web.fire.10');\n        }\n    },\n\n    picLoadComplete (err, res) {\n        if (err || !res) {\n            console.log(err);\n            this.remindLabel.textKey =  i18n.t('cases/05_scripting/11_network/download-web.fire.5.2');\n            return;\n        }\n\n        this.remindLabel.textKey = i18n.t('cases/05_scripting/11_network/download-web.fire.4.2');\n\n        let spriteFrame = new cc.SpriteFrame(res);\n        this.picNode.spriteFrame = spriteFrame;\n        this.picNode.node.active = true;\n    },\n\n    onProgress (completedCount, totalCount) {\n        this.remindLabel.textKey = `${i18n.t('cases/05_scripting/11_network/download-web.fire.3')} ${(completedCount/totalCount) * 100}`;\n    },\n\n});\n"]}