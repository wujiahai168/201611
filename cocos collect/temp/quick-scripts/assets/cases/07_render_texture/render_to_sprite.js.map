{"version":3,"sources":["render_to_sprite.js"],"names":["cc","Class","extends","Component","properties","sprite","default","type","Sprite","camera","Camera","start","texture","RenderTexture","initWithSize","visibleRect","width","height","spriteFrame","SpriteFrame","setTexture","targetTexture","renderTexture","saveImage","CC_JSB","data","readPixels","filePath","jsb","fileUtils","getWritablePath","success","saveImageData","log","error"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,gBAAQ;AACJC,qBAAS,IADL;AAEJC,kBAAMP,GAAGQ;AAFL,SADA;;AAMRC,gBAAQ;AACJH,qBAAS,IADL;AAEJC,kBAAMP,GAAGU;AAFL;AANA,KAHP;;AAeL;;AAEA;;AAEAC,SAnBK,mBAmBI;AACL,YAAIC,UAAU,IAAIZ,GAAGa,aAAP,EAAd;AACAD,gBAAQE,YAAR,CAAqBd,GAAGe,WAAH,CAAeC,KAApC,EAA2ChB,GAAGe,WAAH,CAAeE,MAA1D;;AAEA,YAAIC,cAAc,IAAIlB,GAAGmB,WAAP,EAAlB;AACAD,oBAAYE,UAAZ,CAAuBR,OAAvB;AACA,aAAKP,MAAL,CAAYa,WAAZ,GAA0BA,WAA1B;;AAEA,aAAKT,MAAL,CAAYY,aAAZ,GAA4BT,OAA5B;;AAEA,aAAKU,aAAL,GAAqBV,OAArB;AACH,KA9BI;;;AAgCL;;AAEAW,aAlCK,uBAkCQ;AACT,YAAIC,MAAJ,EAAY;;AAER,gBAAIC,OAAO,KAAKH,aAAL,CAAmBI,UAAnB,EAAX;AACA,gBAAIV,QAAQ,KAAKM,aAAL,CAAmBN,KAA/B;AACA,gBAAIC,SAAS,KAAKK,aAAL,CAAmBL,MAAhC;AACA,gBAAIU,WAAWC,IAAIC,SAAJ,CAAcC,eAAd,KAAkC,4BAAjD;;AAEA,gBAAIC,UAAUH,IAAII,aAAJ,CAAkBP,IAAlB,EAAwBT,KAAxB,EAA+BC,MAA/B,EAAuCU,QAAvC,CAAd;AACA,gBAAII,OAAJ,EAAa;AACT/B,mBAAGiC,GAAH,CAAO,oCAAoCN,QAA3C;AACH,aAFD,MAGK;AACD3B,mBAAGkC,KAAH,CAAS,yBAAT;AACH;AACJ,SAdD,MAeK;AACDlC,eAAGiC,GAAH,CAAO,+CAAP;AACH;AACJ;AArDI,CAAT","file":"render_to_sprite.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\cases\\07_render_texture","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        sprite: {\n            default: null,\n            type: cc.Sprite\n        },\n\n        camera: {\n            default: null,\n            type: cc.Camera\n        }\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n        let texture = new cc.RenderTexture();\n        texture.initWithSize(cc.visibleRect.width, cc.visibleRect.height);\n\n        let spriteFrame = new cc.SpriteFrame();\n        spriteFrame.setTexture(texture)\n        this.sprite.spriteFrame = spriteFrame;\n        \n        this.camera.targetTexture = texture;\n\n        this.renderTexture = texture;\n    },\n\n    // update (dt) {},\n\n    saveImage () {\n        if (CC_JSB) {\n\n            let data = this.renderTexture.readPixels();\n            let width = this.renderTexture.width;\n            let height = this.renderTexture.height;\n            let filePath = jsb.fileUtils.getWritablePath() + 'render_to_sprite_image.png';\n\n            let success = jsb.saveImageData(data, width, height, filePath);\n            if (success) {\n                cc.log(\"save image data success, file: \" + filePath);\n            }\n            else {\n                cc.error(\"save image data failed!\");\n            }\n        }\n        else {\n            cc.log(\"saveImage, only supported on native platform.\");\n        }\n    },\n});\n"]}